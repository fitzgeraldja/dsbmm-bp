# TODO: implement BP again but using sparse formulation so can fully take advantage of scaling

